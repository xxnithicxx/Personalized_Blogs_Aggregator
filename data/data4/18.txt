How To Handle Missing Values In Machine Learning Data With Weka
https://machinelearningmastery.com/how-to-handle-missing-values-in-machine-learning-data-with-weka/
2016-07-10
Data is rarely clean and often you can have corrupt or missing values.
It is important to identify, mark and handle missing data when developing machine learning models in order to get the very best performance.
In this post you will discover how to handle missing values in your machine learning data using Weka.
After reading this post you will know:
- How to mark missing values in your dataset.
- How to remove data with missing values from your dataset.
- How to impute missing values.
Kick-start your project with my new book Machine Learning Mastery With Weka, including step-by-step tutorials and clear screenshots for all examples.
Let’s get started.
How To Handle Missing Data For Machine Learning in WekaPhoto by Peter Sitte, some rights reserved.
# Predict the Onset of Diabetes
The problem used for this example is the Pima Indians onset of diabetes dataset.
It is a classification problem where each instance represents medical details for one patient and the task is to predict whether the patient will have an onset of diabetes within the next five years.
You can learn more about the dataset here:
- Dataset File.
- Dataset Details
You can also access this dataset in your Weka installation, under the data/ directory in the file called diabetes.arff.




# Mark Missing Values
The Pima Indians dataset is a good basis for exploring missing data.
Some attributes such as blood pressure (pres) and Body Mass Index (mass) have values of zero, which are impossible. These are examples of corrupt or missing data that must be marked manually.
You can mark missing values in Weka using the NumericalCleaner filter. The recipe below shows you how to use this filter to mark the 11 missing values on the Body Mass Index (mass) attribute.
1. Open the Weka Explorer.
2. Load the Pima Indians onset of diabetes dataset.
3. Click the “Choose” button for the Filter and select NumericalCleaner, it us under unsupervized.attribute.NumericalCleaner.
Weka Select NumericCleaner Data Filter
4. Click on the filter to configure it.
5. Set the attributeIndicies to 6, the index of the mass attribute.
6. Set minThreshold to 0.1E-8 (close to zero), which is the minimum value allowed for the attribute.
7. Set minDefault to NaN, which is unknown and will replace values below the threshold.
8. Click the “OK” button on the filter configuration.
9. Click the “Apply” button to apply the filter.
Click “mass” in the “attributes” pane and review the details of the “selected attribute”. Notice that the 11 attribute values that were formally set to 0 are not marked as Missing.
Weka Missing Data Marked
In this example we marked values below a threshold as missing.
You could just as easily mark them with a specific numerical value. You could also mark values missing between a upper and lower range of values.
Next, let’s look at how we can remove instances with missing values from our dataset.
# Remove Missing Data
Now that you know how to mark missing values in your data, you need to learn how to handle them.
A simple way to handle missing data is to remove those instances that have one or more missing values.
You can do this in Weka using the RemoveWithValues filter.
Continuing on from the above recipe to mark missing values, you can remove missing values as follows:
1. Click the “Choose” button for the Filter and select RemoveWithValues, it us under unsupervized.instance.RemoveWithValues.
Weka Select RemoveWithValues Data Filter
2. Click on the filter to configure it.
3. Set the attributeIndicies to 6, the index of the mass attribute.
4. Set matchMissingValues to “True”.
5. Click the “OK” button to use the configuration for the filter.
6. Click the “Apply” button to apply the filter.
Click “mass” in the “attributes” section and review the details of the “selected attribute”.
Notice that the 11 attribute values that were marked Missing have been removed from the dataset.
Weka Missing Values Removed
Note, you can undo this operation by clicking the “Undo” button.
# Impute Missing Values
Instances with missing values do not have to be removed, you can replace the missing values with some other value.
This is called imputing missing values.
It is common to impute missing values with the mean of the numerical distribution. You can do this easily in Weka using the ReplaceMissingValues filter.
Continuing on from the first recipe above to mark missing values, you can impute the missing values as follows:
1. Click the “Choose” button for the Filter and select ReplaceMissingValues, it us under unsupervized.attribute.ReplaceMissingValues.
Weka ReplaceMissingValues Data Filter
2. Click the “Apply” button to apply the filter to your dataset.
Click “mass” in the “attributes” section and review the details of the “selected attribute”.
Notice that the 11 attribute values that were marked Missing have been set to the mean value of the distribution.
Weka Imputed Values
# Summary
In this post you discovered how you can handle missing data in your machine learning dataset using Weka.
Specifically, you learned:
- How to mark corrupt values as missing in your dataset.
- How to remove instances with missing values from your dataset.
- How to impute mean values for missing values in your dataset.
Do you have any questions about missing data or about this tutorial? Ask your questions in the comments below and I will do my best to answer.
# Discover Machine Learning Without The Code!
...with just a few a few clicks
Discover how in my new Ebook:
Machine Learning Mastery With Weka
Covers self-study tutorials and end-to-end projects like:
Loading data, visualization, build models, tuning, and much more...
Skip the Academics. Just Results.
See What's Inside

'''

'''
